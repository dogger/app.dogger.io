version: '3.4'

services:
  dogger-setup:
    build: 
        context: .
        dockerfile: ./Dogger.Setup/Dockerfile
    image: docker.pkg.github.com/dogger/app.dogger.io/dogger-setup:${DOGGER_TAG:-latest}
    networks:
    - network
    volumes:
    - "./:/pwd/"
    environment:
    - Aws__AccessKeyId=${AWS_ACCESS_KEY_ID}
    - Aws__SecretAccessKey=${AWS_SECRET_ACCESS_KEY}
    - Aws__LightsailPrivateKeyPem=${AWS_LIGHTSAIL_PRIVATE_KEY_PEM:-}
    - Dogfeed__DockerRegistry__HostName=${DOCKER_REGISTRY_URL:-docker.pkg.github.com}
    - Dogfeed__DockerRegistry__Username=${DOCKER_REGISTRY_USERNAME:-}
    - Dogfeed__DockerRegistry__Password=${DOCKER_REGISTRY_PASSWORD:-}
    - Dogfeed__DockerComposeYmlFilePaths__0=${DOCKER_COMPOSE_YML_FILE_PATHS_0:-}
    - Dogfeed__DockerComposeYmlFilePaths__1=${DOCKER_COMPOSE_YML_FILE_PATHS_1:-}
    - Dogfeed__DockerComposeYmlFilePaths__2=${DOCKER_COMPOSE_YML_FILE_PATHS_2:-}
    - Dogfeed__DockerComposeYmlFilePaths__3=${DOCKER_COMPOSE_YML_FILE_PATHS_3:-}
    - Dogfeed__DockerComposeYmlFilePaths__4=${DOCKER_COMPOSE_YML_FILE_PATHS_4:-}
    - Dogfeed__DockerComposeYmlFilePaths__5=${DOCKER_COMPOSE_YML_FILE_PATHS_5:-}
    - Dogfeed__AdditionalFilePaths__0=${DOCKER_COMPOSE_YML_FILE_PATHS_0:-}
    - Dogfeed__AdditionalFilePaths__1=${DOCKER_COMPOSE_YML_FILE_PATHS_1:-}
    - Dogfeed__AdditionalFilePaths__2=${DOCKER_COMPOSE_YML_FILE_PATHS_2:-}
    - Dogfeed__AdditionalFilePaths__3=${DOCKER_COMPOSE_YML_FILE_PATHS_3:-}
    - Dogfeed__AdditionalFilePaths__4=${DOCKER_COMPOSE_YML_FILE_PATHS_4:-}
    - Dogfeed__AdditionalFilePaths__5=${DOCKER_COMPOSE_YML_FILE_PATHS_5:-}
    - Dogfeed__Tag=${DOGGER_TAG:-latest}
    - Stripe__SecretKey=${STRIPE_SECRET_KEY:-}
    - Stripe__PublishableKey=${STRIPE_PUBLISHABLE_KEY:-}
    - GitHub__PullDog__PrivateKey=${PULL_DOG_PRIVATE_KEY:-}
    - GitHub__PullDog__AppIdentifier=${PULL_DOG_APP_IDENTIFIER:-}
    - GitHub__PullDog__WebhookSecret=${PULL_DOG_WEBHOOK_SECRET:-}
    - GitHub__PullDog__ClientId=${PULL_DOG_CLIENT_ID:-}
    - GitHub__PullDog__ClientSecret=${PULL_DOG_CLIENT_SECRET:-}
    - Auth0__ClientId=${AUTHZERO_CLIENT_ID:-}
    - Auth0__ClientSecret=${AUTHZERO_CLIENT_SECRET:-}
    - DOGGER_TAG=${DOGGER_TAG:-latest}
    - ASPNETCORE_ENVIRONMENT=Production

networks:
  network: